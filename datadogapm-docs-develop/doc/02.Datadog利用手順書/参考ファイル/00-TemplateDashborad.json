{"title":"00-TemplateDashborad","description":"[[suggested_dashboards]] ","widgets":[{"id":918739064809088,"definition":{"title":"リクエスト","background_color":"vivid_green","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":544375177110030,"definition":{"title":"リクエスト件数（カウント）","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:trace.servlet.request.hits{*} by {service}.as_count()"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":0,"width":6,"height":3}}]},"layout":{"x":0,"y":0,"width":12,"height":1}},{"id":8151957049437468,"definition":{"title":"レスポンス","background_color":"vivid_green","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":2807954124817449,"definition":{"title":"レスポンス時間（最大）","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"name":"query1","data_source":"spans","search":{"query":""},"indexes":["*"],"group_by":[{"facet":"service","limit":10,"sort":{"aggregation":"max","order":"desc","metric":"@duration"},"should_exclude_missing":true}],"compute":{"aggregation":"max","metric":"@duration"},"storage":"hot"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":0,"width":6,"height":3}},{"id":5841082196668066,"definition":{"title":"レスポンス時間（平均）","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"name":"query1","data_source":"spans","search":{"query":""},"indexes":["*"],"group_by":[{"facet":"service","limit":10,"sort":{"aggregation":"avg","order":"desc","metric":"@duration"},"should_exclude_missing":true}],"compute":{"aggregation":"avg","metric":"@duration"},"storage":"hot"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":0,"width":6,"height":3}},{"id":1060007196004548,"definition":{"title":"レスポンス時間（９０％）","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"},{"formula":"query2"},{"formula":"query3"},{"formula":"query4"}],"queries":[{"name":"query1","data_source":"spans","search":{"query":"env:app service:kzr02-com-example-kzr02-apm-foodshop-us "},"indexes":["*"],"group_by":[],"compute":{"aggregation":"pc90","metric":"@duration"},"storage":"hot"},{"name":"query2","data_source":"spans","search":{"query":"env:app service:kzw04-com-example-kzw04-apm-foodshop-bs "},"indexes":["*"],"group_by":[],"compute":{"aggregation":"pc90","metric":"@duration"},"storage":"hot"},{"name":"query3","data_source":"spans","search":{"query":"env:app service:kzw02-com-example-kzw02-apm-foodshop-bs "},"indexes":["*"],"group_by":[],"compute":{"aggregation":"pc90","metric":"@duration"},"storage":"hot"},{"name":"query4","data_source":"spans","search":{"query":"env:app service:kzr04-com-example-kzr04-apm-foodshop-us "},"indexes":["*"],"group_by":[],"compute":{"aggregation":"pc90","metric":"@duration"},"storage":"hot"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":3,"width":6,"height":3}},{"id":138283151910909,"definition":{"title":"レスポンス分布","title_size":"16","title_align":"left","show_legend":true,"type":"distribution","xaxis":{"scale":"linear","min":"auto","max":"auto","include_zero":true},"yaxis":{"scale":"linear","min":"auto","max":"auto","include_zero":true},"requests":[{"request_type":"histogram","query":{"name":"query1","data_source":"spans","search":{"query":""},"indexes":["*"],"group_by":[],"compute":{"aggregation":"sum","metric":"@duration"},"storage":"hot"}}]},"layout":{"x":6,"y":3,"width":6,"height":3}}]},"layout":{"x":0,"y":1,"width":12,"height":1}},{"id":5790592573699578,"definition":{"title":"JVM","background_color":"vivid_green","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":1573554742522948,"definition":{"title":"JVM heap memory pool committed bytes","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:jvm.heap_memory_committed{*}"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":0,"width":6,"height":3}},{"id":8080035001315207,"definition":{"title":"JVM heap memory pool used bytes","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:jvm.heap_memory{*} by {service}"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":0,"width":6,"height":3}},{"id":2975811244341869,"definition":{"title":"JVM garbage collection count","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query2"}],"queries":[{"data_source":"metrics","name":"query2","query":"avg:jvm.gc.minor_collection_count{*} by {service}"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":3,"width":6,"height":3}},{"id":1161361308571914,"definition":{"title":"JVM garbage collection time","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query3"}],"queries":[{"data_source":"metrics","name":"query3","query":"avg:jvm.gc.minor_collection_time{*} by {service}"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":3,"width":6,"height":3}},{"id":5406261698421907,"definition":{"title":"JVM garbage collection count (Eden)","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query2"}],"queries":[{"data_source":"metrics","name":"query2","query":"avg:jvm.gc.minor_collection_count{*} by {service}"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":6,"width":4,"height":3}},{"id":5665105775667980,"definition":{"title":"JVM garbage collection time (Eden)","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query3"}],"queries":[{"data_source":"metrics","name":"query3","query":"avg:jvm.gc.minor_collection_time{*} by {service}"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":4,"y":6,"width":4,"height":3}},{"id":5943735245857319,"definition":{"title":"JVM garbage collection size (Eden)","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query3"}],"queries":[{"data_source":"metrics","name":"query3","query":"avg:jvm.gc.eden_size{*} by {service}"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":8,"y":6,"width":4,"height":3}},{"id":1701290107178005,"definition":{"title":"JVM garbage collection time (G1 Old Gen)","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query4"}],"queries":[{"data_source":"metrics","name":"query4","query":"avg:jvm.gc.major_collection_time{*} by {service}"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":9,"width":4,"height":3}},{"id":8520036248872760,"definition":{"title":"JVM garbage collection count (G1 Old Gen)","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:jvm.gc.major_collection_count{*} by {service}"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":4,"y":9,"width":4,"height":3}},{"id":1813478451468309,"definition":{"title":"JVM garbage collection size (G1 Old Gen)","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query4"}],"queries":[{"data_source":"metrics","name":"query4","query":"avg:jvm.gc.old_gen_size{*} by {service}"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":8,"y":9,"width":4,"height":3}}]},"layout":{"x":0,"y":2,"width":12,"height":1}},{"id":4547448797077312,"definition":{"title":"Kubernetes状況","background_color":"vivid_green","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":6431830807270198,"definition":{"title":"Node 最大CPU使用率","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"max:kubernetes.cpu.usage.total{kube_node:aks-nodepool9*} by {host}"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":0,"width":6,"height":3}},{"id":1372248509540932,"definition":{"title":"Node 平均CPU使用率","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:kubernetes.cpu.usage.total{kube_node:aks-nodepool9*} by {host}"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":0,"width":6,"height":3}},{"id":5793688299820092,"definition":{"title":"Node 最大メモリ使用率","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"max:kubernetes.memory.usage{kube_node:aks-nodepool9*} by {host}"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":3,"width":6,"height":3}},{"id":7514557139763300,"definition":{"title":"Node 平均メモリ使用率","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:kubernetes.memory.usage{kube_node:aks-nodepool9*} by {host}"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":3,"width":6,"height":3}},{"id":7481446966011100,"definition":{"title":"Services per cluster","title_size":"16","title_align":"left","type":"query_value","requests":[{"conditional_formats":[{"comparator":">","value":0,"palette":"white_on_green"}],"response_format":"scalar","queries":[{"data_source":"metrics","name":"query1","query":"sum:kubernetes_state.service.count{*}","aggregator":"last"}]}],"precision":0},"layout":{"x":0,"y":6,"width":4,"height":2}},{"id":4878872669848812,"definition":{"title":"Service types per cluster","title_size":"16","title_align":"left","show_legend":false,"legend_size":"0","type":"timeseries","requests":[{"on_right_yaxis":false,"response_format":"timeseries","queries":[{"data_source":"metrics","name":"query1","query":"sum:kubernetes_state.service.count{*} by {type}"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"area"}],"yaxis":{"label":"","scale":"linear","include_zero":true,"min":"auto","max":"auto"}},"layout":{"x":4,"y":6,"width":4,"height":2}},{"id":4310665554769858,"definition":{"title":"Pods running by Service","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"on_right_yaxis":false,"response_format":"timeseries","queries":[{"data_source":"metrics","name":"query1","query":"sum:kubernetes.pods.running{*} by {kube_service}"}],"formulas":[{"formula":"exclude_null(query1)"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"bars"}],"yaxis":{"label":"","scale":"linear","include_zero":true,"min":"auto","max":"auto"}},"layout":{"x":8,"y":6,"width":4,"height":2}},{"id":8631691540003607,"definition":{"title":"Service 最大CPU使用率","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"max:kubernetes.cpu.usage.total{service:*} by {service}"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":8,"width":6,"height":3}},{"id":3455911431845553,"definition":{"title":"Service 平均CPU使用率","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:kubernetes.cpu.usage.total{service:*} by {service}"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":8,"width":6,"height":3}},{"id":8757423028430587,"definition":{"title":"Service 最大メモリ使用率","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"max:kubernetes.memory.usage{service:*} by {service}"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":11,"width":6,"height":3}},{"id":1466374959917459,"definition":{"title":"Service 平均メモリ使用率","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:kubernetes.memory.usage{service:*} by {service}"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":11,"width":6,"height":3}},{"id":8243991632823016,"definition":{"title":"Pod毎のCPU Requests, Limits and Usage（平均、最小、最大）","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max"],"type":"timeseries","requests":[{"formulas":[{"alias":"Cores used","formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:container.cpu.usage{pod_name:*,kube_namespace:*,kube_cluster_name:aks043-bs-dev-001} by {pod_name}.fill(null).rollup(avg, 20)"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"},{"formulas":[{"alias":"Cores limits","formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:kubernetes.cpu.limits{pod_name:*,kube_namespace:*,kube_cluster_name:aks043-bs-dev-001} by {pod_name}.fill(null).rollup(avg, 20)"}],"response_format":"timeseries","style":{"palette":"Oranges","line_type":"dashed","line_width":"thin"},"display_type":"line"},{"formulas":[{"alias":"Cores requests","formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:kubernetes.cpu.requests{pod_name:*,kube_namespace:*,kube_cluster_name:aks043-bs-dev-001} by {pod_name}.fill(null).rollup(avg, 20)"}],"response_format":"timeseries","style":{"palette":"Greys","line_type":"dotted","line_width":"thin"},"display_type":"line"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"}},"layout":{"x":0,"y":14,"width":6,"height":4}},{"id":5531166217164166,"definition":{"title":"Pod毎のCPU Requests, Limits and Usage（平均、最小、最大）前週分","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max"],"type":"timeseries","requests":[{"formulas":[{"alias":"Cores used","formula":"calendar_shift(query1, '-1w', 'Asia/Tokyo')"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:container.cpu.usage{pod_name:*,kube_namespace:*,kube_cluster_name:aks043-bs-dev-001} by {pod_name}.fill(null).rollup(avg, 20)"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"},{"formulas":[{"alias":"Cores limits","formula":"calendar_shift(query1, '-1w', 'Asia/Tokyo')"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:kubernetes.cpu.limits{pod_name:*,kube_namespace:*,kube_cluster_name:aks043-bs-dev-001} by {pod_name}.fill(null).rollup(avg, 20)"}],"response_format":"timeseries","style":{"palette":"Oranges","line_type":"dashed","line_width":"thin"},"display_type":"line"},{"formulas":[{"alias":"Cores requests","formula":"calendar_shift(query1, '-1w', 'Asia/Tokyo')"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:kubernetes.cpu.requests{pod_name:*,kube_namespace:*,kube_cluster_name:aks043-bs-dev-001} by {pod_name}.fill(null).rollup(avg, 20)"}],"response_format":"timeseries","style":{"palette":"Greys","line_type":"dotted","line_width":"thin"},"display_type":"line"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"}},"layout":{"x":6,"y":14,"width":6,"height":4}},{"id":4434125349925976,"definition":{"title":"Pod毎のMemory Requests, Limits and Usage（平均、最小、最大）","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max"],"type":"timeseries","requests":[{"formulas":[{"alias":"Memory used","formula":"query1"},{"alias":"Working set","formula":"query2"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:container.memory.usage{pod_name:*,kube_namespace:*,kube_cluster_name:aks043-bs-dev-001} by {pod_name}.fill(null).rollup(avg, 20)"},{"data_source":"metrics","name":"query2","query":"avg:container.memory.working_set{pod_name:*,kube_namespace:*,kube_cluster_name:aks043-bs-dev-001} by {pod_name}.fill(null).rollup(avg, 20)"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"},{"formulas":[{"alias":"Memory limits","formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:kubernetes.memory.limits{pod_name:*,kube_namespace:*,kube_cluster_name:aks043-bs-dev-001} by {pod_name}.fill(null).rollup(avg, 20)"}],"response_format":"timeseries","style":{"palette":"Oranges","line_type":"dashed","line_width":"thin"},"display_type":"line"},{"formulas":[{"alias":"Memory requests","formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:kubernetes.memory.requests{pod_name:product-recommendation-5d85fcc76c-45z79,kube_namespace:default,kube_cluster_name:dev-aks-shopist-a-northcentralus} by {pod_name}.fill(null).rollup(avg, 20)"}],"response_format":"timeseries","style":{"palette":"Greys","line_type":"dotted","line_width":"thin"},"display_type":"line"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"}},"layout":{"x":0,"y":18,"width":6,"height":3}},{"id":3189235186512450,"definition":{"title":"Pod毎のMemory Requests, Limits and Usage（平均、最小、最大）前週分","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max"],"type":"timeseries","requests":[{"formulas":[{"alias":"Memory used","formula":"calendar_shift(query1, '-1w', 'Asia/Tokyo')"},{"alias":"Memory used","formula":"calendar_shift(query2, '-1w', 'Asia/Tokyo')"},{"alias":"Memory used","formula":"calendar_shift(query3, '-1w', 'Asia/Tokyo')"},{"alias":"Memory used","formula":"calendar_shift(query4, '-1w', 'Asia/Tokyo')"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:container.memory.usage{pod_name:*,kube_namespace:*,kube_cluster_name:*} by {pod_name}.fill(null).rollup(avg, 20)"},{"data_source":"metrics","name":"query2","query":"avg:containerd.mem.working_set{pod_name:*,kube_namespace:*,kube_cluster_name:*} by {pod_name}.fill(null).rollup(avg, 20)"},{"data_source":"metrics","name":"query3","query":"avg:kubernetes.memory.limits{pod_name:*,kube_namespace:*,kube_cluster_name:*} by {pod_name}.fill(null).rollup(avg, 20)"},{"data_source":"metrics","name":"query4","query":"avg:kubernetes.memory.limits{pod_name:*,kube_namespace:*,kube_cluster_name:*} by {pod_name}.fill(null).rollup(avg, 20)"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"}},"layout":{"x":6,"y":18,"width":6,"height":3}},{"id":5386084132172182,"definition":{"title":"コンテナ毎のメモリSwap発生状況","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:container.memory.swap{service:*} by {container_name}"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":21,"width":6,"height":2}}]},"layout":{"x":0,"y":3,"width":12,"height":1}},{"id":5019386681745038,"definition":{"title":"DB","background_color":"vivid_green","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":2474091253426354,"definition":{"title":"SQLクエリの応答時間（クエリ毎）","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"name":"query1","data_source":"spans","search":{"query":"service:* operation_name:postgres.query "},"indexes":["*"],"group_by":[{"facet":"resource_name","limit":100,"sort":{"aggregation":"avg","order":"desc","metric":"@duration"},"should_exclude_missing":true}],"compute":{"aggregation":"avg","metric":"@duration"},"storage":"hot"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":0,"width":4,"height":6}},{"id":3338273507744916,"definition":{"title":"SQLクエリ失敗率（クエリ毎）","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"apm_metrics","name":"query1","stat":"error_rate","service":"*","operation_name":"postgres.query","group_by":["resource_name"]}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":4,"y":0,"width":4,"height":6}},{"id":1367224668430318,"definition":{"title":"SQLクエリ数（クエリ毎）","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"apm_metrics","name":"query1","stat":"hits","service":"*","operation_name":"postgres.query","group_by":["resource_name"]}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":8,"y":0,"width":4,"height":6}},{"id":2399208233034876,"definition":{"title":"データベース変更操作のSQLクエリの応答時間","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"name":"query1","data_source":"spans","search":{"query":"service:* operation_name:postgres.query resource_name:(INSERT* OR DELETE* OR UPDATE*) "},"indexes":["*"],"group_by":[{"facet":"resource_name","limit":100,"sort":{"aggregation":"avg","order":"desc","metric":"@duration"},"should_exclude_missing":true}],"compute":{"aggregation":"avg","metric":"@duration"},"storage":"hot"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":6,"width":4,"height":6}},{"id":904533845792930,"definition":{"title":"データベース変更操作のSQLクエリの失敗率","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1 / query2"}],"queries":[{"name":"query1","data_source":"spans","search":{"query":"service:auth-dotnet operation_name:postgres.query resource_name:(INSERT* OR DELETE* OR UPDATE*) status:error"},"indexes":["*"],"group_by":[{"facet":"resource_name","limit":100,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true}],"compute":{"aggregation":"count","metric":"count"},"storage":"hot"},{"name":"query2","data_source":"spans","search":{"query":"service:auth-dotnet operation_name:postgres.query resource_name:(INSERT* OR DELETE* OR UPDATE*)"},"indexes":["*"],"group_by":[{"facet":"resource_name","limit":100,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true}],"compute":{"aggregation":"count","metric":"count"},"storage":"hot"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":4,"y":6,"width":4,"height":6}},{"id":5561297570180024,"definition":{"title":"データベース変更操作のSQLクエリ数","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"name":"query1","data_source":"spans","search":{"query":"service:* operation_name:postgres.query resource_name:(INSERT* OR DELETE* OR UPDATE*) "},"indexes":["*"],"group_by":[{"facet":"resource_name","limit":100,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true}],"compute":{"aggregation":"count","metric":"count"},"storage":"hot"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":8,"y":6,"width":4,"height":6}},{"id":6581155855745172,"definition":{"title":"SQLクエリの応答時間","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"name":"query1","data_source":"spans","search":{"query":"service:* operation_name:postgres.query "},"indexes":["*"],"group_by":[],"compute":{"aggregation":"avg","metric":"@duration"},"storage":"hot"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":12,"width":4,"height":6}},{"id":4066855472548892,"definition":{"title":"SQLクエリ失敗率","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"apm_metrics","name":"query1","stat":"error_rate","service":"*","operation_name":"postgres.query"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":4,"y":12,"width":4,"height":6}},{"id":1533270103884148,"definition":{"title":"SQLクエリ数","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"apm_metrics","name":"query1","stat":"hits","service":"*","operation_name":"postgres.query"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":8,"y":12,"width":4,"height":6}},{"id":807555414102006,"definition":{"title":"postgresサーバ稼働時間","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:postgresql.uptime{*} by {server}"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":false,"scale":"log"},"markers":[{"label":"y = 0","value":"y = 0","display_type":"error dashed"}]},"layout":{"x":0,"y":18,"width":12,"height":3}},{"id":5467749630467574,"definition":{"title":"Azure SQL server Total Connections（成功／失敗）","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"horizontal","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"Failed","formula":"query1"}],"response_format":"timeseries","queries":[{"query":"sum:azure.sql_servers_databases.connection_failed{*}.as_count()","data_source":"metrics","name":"query1"}],"style":{"palette":"red","line_type":"solid","line_width":"normal"},"display_type":"area"},{"formulas":[{"alias":"Successful","formula":"query0"}],"response_format":"timeseries","queries":[{"query":"sum:azure.sql_servers_databases.connection_successful{*}.as_count()","data_source":"metrics","name":"query0"}],"style":{"palette":"green","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":21,"width":12,"height":3}}]},"layout":{"x":0,"y":4,"width":12,"height":1,"is_column_break":true}},{"id":8517780805484592,"definition":{"title":"エンドポイント別の状況","background_color":"vivid_green","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":7583848017646330,"definition":{"title":"現時点のエラー件数","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:trace.servlet.request.errors{service:*} by {resource_name}.as_count()"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":0,"width":6,"height":3}},{"id":4940674955589732,"definition":{"title":"前週のエラー件数","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"calendar_shift(query1, '-1w', 'Asia/Tokyo')"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:trace.servlet.request.errors{service:*} by {resource_name}.as_count()"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":0,"width":6,"height":3}},{"id":4947658797612810,"definition":{"title":"現時点の応答時間","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:trace.servlet.request.duration{service:*} by {resource_name}"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":3,"width":4,"height":3}},{"id":8142896787727864,"definition":{"title":"前週の応答時間","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"calendar_shift(query1, '-1w', 'Asia/Tokyo')"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:trace.servlet.request.duration{service:*} by {resource_name}"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":4,"y":3,"width":4,"height":3}},{"id":593328773735850,"definition":{"title":"過去七日間の応答時間","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max","value","sum"],"time":{"type":"fixed","from":1723694559523,"to":1724299359523},"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:trace.servlet.request.duration{service:*} by {resource_name}"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":8,"y":3,"width":4,"height":3}},{"id":2587352576956422,"definition":{"title":"エンドポイント毎のリクエストエラー率","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"apm_metrics","name":"query1","stat":"error_rate","service":"*","group_by":["resource_name"]}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":6,"width":6,"height":3}}]},"layout":{"x":0,"y":5,"width":12,"height":1}},{"id":8373273386964360,"definition":{"title":"エラー件数","background_color":"vivid_green","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":4989961674588084,"definition":{"title":"ServiceA 5xx","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"data_source":"apm_metrics","name":"query1","stat":"errors","group_by":[],"service":"*","query_filter":"http.status_code:5*"}],"formulas":[{"formula":"query1"}]}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area"}},"layout":{"x":0,"y":0,"width":2,"height":2}},{"id":5989427231126224,"definition":{"title":"ServiceA 4xx","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"data_source":"apm_metrics","name":"query1","stat":"errors","group_by":[],"service":"*","query_filter":"http.status_code:4*","operation_name":"http.request"}],"formulas":[{"formula":"query1"}]}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area"}},"layout":{"x":2,"y":0,"width":2,"height":2}},{"id":4280327221789126,"definition":{"title":"ServiceB 5xx","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"data_source":"apm_metrics","name":"query1","stat":"errors","group_by":[],"service":"*","query_filter":"http.status_code:5*"}],"formulas":[{"formula":"query1"}]}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area"}},"layout":{"x":4,"y":0,"width":2,"height":2}},{"id":1683541265033024,"definition":{"title":"ServiceB 4xx","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"data_source":"apm_metrics","name":"query1","stat":"errors","group_by":[],"service":"*","query_filter":"http.status_code:4*","operation_name":"http.request"}],"formulas":[{"formula":"query1"}]}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area"}},"layout":{"x":6,"y":0,"width":2,"height":2}},{"id":4580550225722230,"definition":{"title":"ServiceC 5xx","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"data_source":"apm_metrics","name":"query1","stat":"errors","group_by":[],"service":"*","query_filter":"http.status_code:5*"}],"formulas":[{"formula":"query1"}]}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area"}},"layout":{"x":8,"y":0,"width":2,"height":2}},{"id":6909814695615382,"definition":{"title":"ServiceC 4xx","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"data_source":"apm_metrics","name":"query1","stat":"errors","group_by":[],"service":"*","query_filter":"http.status_code:4*","operation_name":"http.request"}],"formulas":[{"formula":"query1"}]}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area"}},"layout":{"x":10,"y":0,"width":2,"height":2}}]},"layout":{"x":0,"y":6,"width":12,"height":1}}],"template_variables":[],"layout_type":"ordered","notify_list":[],"reflow_type":"fixed"}